<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Chrome, Firefox OS and Opera Status Bar Color -->
  <meta name="theme-color" content="#FFFFFF">
  <meta property="og:title" content="Modeling the perceived gender of names">
    <meta name="description" content="I build and test an ML model to predict the perceived gender of a name in a given country.">
  <meta property="og:description" content="I build and test an ML model to predict the perceived gender of a name in a given country.">
    <meta property="og:type" content="blog">
  <title>Modeling the perceived gender of names</title>
  <!-- Favicon -->
    <link rel="shortcut icon" href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F320633e8-3085-4580-acbd-ebf160eeed36%2Fhome.png?table=collection&id=c028b1e3-fce7-415e-96c6-cf8b2be3919a">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
  <link rel="stylesheet" type="text/css"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
  <link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
  <link rel="stylesheet" type="text/css" href="css/notablog.css">
  <link rel="stylesheet" type="text/css" href="css/theme.css">
  <style>
    :root {
      font-size: 18px;
    }

    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
    <a href="index.html">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F320633e8-3085-4580-acbd-ebf160eeed36%2Fhome.png?table=collection&id=c028b1e3-fce7-415e-96c6-cf8b2be3919a"></span> <span>Blog</span></div>
    </a>
                            <span class="Navbar__Delim">&centerdot;</span>
    <a href="about.html">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Ff0df78d3-1d44-498e-8227-78001f637913%2Fabout.png?table=block&id=b5ef726c-6168-43f7-ab47-4080e6397bed"></span> <span>About</span></div>
    </a>
                <span class="Navbar__Delim">&centerdot;</span>
    <a href="photography.html">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F34a8a292-8ecd-460a-9845-834872a45c7a%2Fcamera.png?table=block&id=81e721b8-8434-44d4-a045-f04a6894fadc"></span> <span>Photography</span></div>
    </a>
                <span class="Navbar__Delim">&centerdot;</span>
    <a href="quotes.html">
      <div class="Navbar__Btn"><span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Ff364b72f-6d19-42ce-a239-0a4a25f6ac34%2Fquotes.png?table=block&id=fd698c32-d385-4104-9351-e3b2d84f8e45"></span> <span>Quotes</span></div>
    </a>
                  </nav>
  <header class="Header">
          <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    <h1 class="Header__Title">Modeling the perceived gender of names</h1>
            <div class="DateTagBar">
                <span class="DateTagBar__Item DateTagBar__Date">Posted by <i><a href="about.html">Sesh</a></i> on Mon, Aug 16, 2021</span>
                          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--orange">
            <a href="tag/machine-learning.html">machine-learning</a>
          </span>
                <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--purple">
            <a href="tag/tech.html">tech</a>
          </span>
                  </div>
          </header>
      <article id="https://www.notion.so/d193afb032b1416782423f2566e4c87e" class="PageRoot"><blockquote id="https://www.notion.so/f99aa73e85c1435298e7a194d6f92340" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString">TLDR: I build an ML model to predict the perceived gender of a name in a given country. 
</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">code is </strong></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/seshadrs/nameste"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">here</strong></a></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">.</strong></span></span></blockquote><div id="https://www.notion.so/d4667f1cd8a14a16a15add72bd9bda7b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/6b0fc65985ec4d34a06513eda2133dd7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I was named </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Seshadri</em></span><span class="SemanticString"> in honor of my late grandfather </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Seshadri Sampath</em></span><span class="SemanticString">. It is also one of the many names for the Hindu god </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://en.wikipedia.org/wiki/Vishnu"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Vishnu</em></a></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">. </em></span><span class="SemanticString">In the south Indian state of Tamil Nadu where I&#x27;m from, my first name is understood to be masculine. However in other parts of the world, acquaintances express confusion at reconciling my gender with my name. Once an American phone operator asked that I put &#x27;her&#x27;(</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Seshadri)</em></span><span class="SemanticString"> on the phone upon hearing my male voice ðŸ¤¦. Let us try to understand why this happens with machine learning. &lt;</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">drumroll&gt;</em></span></span></p></div><h3 id="https://www.notion.so/8fad01140e2a46448ea9dcda0627fc6d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/8fad01140e2a46448ea9dcda0627fc6d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">hypothesis</span></span></h3><div id="https://www.notion.so/85ed67589f3e4eadb65680d6058bf809" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Clearly the suffixed &#x27;i&#x27; in my name is the cause for confusion because many names ending in &#x27;i&#x27; tend to be female. I am interested in a person&#x27;s experientially learned name to gender mapping. That would hopefully explain why Americans think my name sounds female. An individual&#x27;s name to gender mapping is a product of their exposure to different cultures, individuals, texts etc. Their location in the world is likely the primary factor at play here.</span></span></p></div><h3 id="https://www.notion.so/d574c914054e4accb01cf048a6ba6503" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/d574c914054e4accb01cf048a6ba6503"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">dataset</span></span></h3><div id="https://www.notion.so/0b4acf2d96ae4acd8211ae98072ce912" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I use the </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/YPRQH8">World Gender Name Dictionary (WGND) dataset</a></span><span class="SemanticString"> which contains ~276k distinct &lt;name, country&gt; pairs; ~176k unique names from 172 countries. For each name we have gender found in different sources the data was collected from. For instance both male and female gender records with first-name &quot;HARPER&quot; are present. This dataset was originally created using name and gender information disclosed in patent applications worldwide (</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.wipo.int/publications/en/details.jsp?id=4125">paper</a></span><span class="SemanticString">), to study gender and geographical disparities.</span></span></p></div><h3 id="https://www.notion.so/65fb3186f89b4f83a23a20587858e809" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/65fb3186f89b4f83a23a20587858e809"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">problem</span></span></h3><div id="https://www.notion.so/24c9c0ca0f374bb083448036b256eeee" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">My goal is to model a name&#x27;s perceived gender for a given country. While gender identity itself is non-binary, we unfortunately only have access to name datasets with male and female pronouns. A name can be </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">female, male or unisex (both) </em></span><span class="SemanticString">in the country of interest</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">.</em></span><span class="SemanticString"> I reduce this multi-class classification problem to a regression problem where the model predicts a </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">maleness</em></span><span class="SemanticString"> score. If all data sources unanimously indicate that the name was male, the score is 1. If they indicate that the name is female, the score is 0. If they are mixed, the score is the fraction of sources that say it is male. Unisex names would have a score close to .5</span></span></p></div><h3 id="https://www.notion.so/22efe48b90194600aa57a30f47a54ffb" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/22efe48b90194600aa57a30f47a54ffb"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">assumptions</span></span></h3><div id="https://www.notion.so/c8b3b31d3fa34069bdb7e933142be8bd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The biggest leap of logic we make is to proxy the reported gender for a name as the perceived gender in the country. While they are not the same, it appears to me they are close enough. The dataset is hamstrung the lack of name frequency information. Without name weighting (typically a power-law distribution), a supervised model would not know that misclassifying &quot;DAVID&quot; is a costlier mistake compared to misclassifying &quot;DRAVID&quot; which is a rare name. Still, the dataset is viable; Popular names tend to be present in many countries, hence will have multiple records, so the frequency information isn&#x27;t entirely lost.</span></span></p></div><h3 id="https://www.notion.so/1200da4553fc4492bc42d091396fd6c2" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/1200da4553fc4492bc42d091396fd6c2"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">preprocessing</span></span></h3><div id="https://www.notion.so/7669246274504deabc90dc052c3dfd16" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The WGND paper noted stark gender disparities that varied by country. For instance, in Canada the number of female inventor names are higher than the males, while in India the female names are a third of the male names. To avoid learning incorrect priors on the imbalanced dataset, I undersample the majority gender class to select equal number of male and female records for each country. I also hid a few names when preparing the dataset. </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Seshadri</em></span><span class="SemanticString"> and </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Sesh </em></span><span class="SemanticString">(my nickname) were held-out for obvious reasons. </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Cersei</em></span><span class="SemanticString">, </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Dobby,</em></span><span class="SemanticString"> </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Daenerys </em></span><span class="SemanticString">and few other fictional names were also held-out to test how well the model generalizes.</span></span></p></div><pre id="https://www.notion.so/b403c1848e924c98b8845f51cf6477ba" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>max_name_length <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">,</span> names_df<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
name_tokenizer <span class="token operator">=</span> Tokenizer<span class="token punctuation">(</span>num_words<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> char_level<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> oov_token<span class="token operator">=</span><span class="token string">'OOV'</span><span class="token punctuation">)</span>
name_tokenizer<span class="token punctuation">.</span>fit_on_texts<span class="token punctuation">(</span>names_df<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
num_name_token_classes <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>name_tokenizer<span class="token punctuation">.</span>word_index<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>

country_code_encoder <span class="token operator">=</span> OneHotEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>
country_code_encoder<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>names_df<span class="token punctuation">.</span>country_code<span class="token punctuation">.</span>to_numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_names_matrix</span><span class="token punctuation">(</span>names<span class="token punctuation">:</span> pandas<span class="token punctuation">.</span>Series<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> to_categorical<span class="token punctuation">(</span>
        pad_sequences<span class="token punctuation">(</span>name_tokenizer<span class="token punctuation">.</span>texts_to_sequences<span class="token punctuation">(</span>names<span class="token punctuation">)</span><span class="token punctuation">,</span> 
                      maxlen<span class="token operator">=</span>max_name_length<span class="token punctuation">,</span> 
                      padding<span class="token operator">=</span><span class="token string">'post'</span><span class="token punctuation">,</span> 
                      truncating<span class="token operator">=</span><span class="token string">'post'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
        num_classes<span class="token operator">=</span> num_name_token_classes<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_country_codes_matrix</span><span class="token punctuation">(</span>codes<span class="token punctuation">:</span> pandas<span class="token punctuation">.</span>Series<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> country_code_encoder<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>codes<span class="token punctuation">.</span>to_numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>todense<span class="token punctuation">(</span><span class="token punctuation">)</span>

names_mat <span class="token operator">=</span> get_names_matrix<span class="token punctuation">(</span>names_df<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
country_codes_mat <span class="token operator">=</span> get_country_codes_matrix<span class="token punctuation">(</span>names_df<span class="token punctuation">.</span>country_code<span class="token punctuation">)</span>
y_mat <span class="token operator">=</span> names_df<span class="token punctuation">.</span>maleness<span class="token punctuation">.</span>to_numpy<span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span></code></pre><h3 id="https://www.notion.so/8ab58ce9c30146408e90af6d5ab9802e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/8ab58ce9c30146408e90af6d5ab9802e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">model</span></span></h3><div id="https://www.notion.so/ded0b5de00294b22a1b8f5576dba743a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I use an LSTM model to embed the sequence of name character tokens. The country code is one hot encoded and concatenated with the name embedding. This concatenated vector is passed through a single dense layer whose output is passed through a single unit sigmoid activation to predict the </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">maleness</em></span><span class="SemanticString"> score. We train it with early stopping, exiting when the validation mean-squared-error doesn&#x27;t improve. The maleness score predictions on the held-out dataset are off by 0.26 on average, which is significantly better than the average score predictor.</span></span></p></div><pre id="https://www.notion.so/97a7b4878dd041068b352e3a31ad3535" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>inputs <span class="token operator">=</span> <span class="token punctuation">[</span>Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span>max_name_length<span class="token punctuation">,</span>num_name_token_classes<span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"input_name_char_seq"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
          Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>country_codes_unique<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"input_country_code_ohe"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
lstm <span class="token operator">=</span> LSTM<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">,</span> return_sequences<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
name_embedding <span class="token operator">=</span> lstm<span class="token punctuation">(</span>inputs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"name_and_country_emb"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>name_embedding<span class="token punctuation">,</span> inputs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span>activation<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
output <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'maleness'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span></span></span></span></code></pre><pre id="https://www.notion.so/2415451546944117aabe9cfc341c3b12" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>5573/5573 [==============================] - 54s 10ms/step 
- loss: 0.1136 - mse: 0.1136 - mae: 0.2360 
- val_loss: 0.1364 - val_mse: 0.1364 - val_mae: 0.2558</span></span></span></code></pre><h3 id="https://www.notion.so/b0d294e4961d433d857fb9d13a8de8b1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/b0d294e4961d433d857fb9d13a8de8b1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">visualization</span></span></h3><div id="https://www.notion.so/005fdccc90a344be8fa578986a285d7a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">I made a Choropleth plot of the batch inference results predicting the maleness scores for every country in the dataset, for a given name input. The results below are for the holdout names.</span></span></p></div><div id="https://www.notion.so/dba6f89a98eb4144b9335437bc050a20" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F2a56bf2f-a4fb-4510-9bf1-b2cb9af278ca%2FScreen_Shot_2021-08-19_at_12.59.44_AM.png?width=432&amp;table=block&amp;id=dba6f89a-98eb-4144-b933-5437bc050a20"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F2a56bf2f-a4fb-4510-9bf1-b2cb9af278ca%2FScreen_Shot_2021-08-19_at_12.59.44_AM.png?width=432&amp;table=block&amp;id=dba6f89a-98eb-4144-b933-5437bc050a20" style="width:432px"/></a><figcaption><span class="SemanticStringArray"><span class="SemanticString">the queen of the seven kingdoms is feminine</span></span></figcaption></figure></div><div id="https://www.notion.so/02fcee71d26b4c96bc2c335d7a5a0274" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F559c9ccf-7ebb-48b6-87a1-b697ba626e39%2FScreen_Shot_2021-08-19_at_1.02.00_AM.png?width=432&amp;table=block&amp;id=02fcee71-d26b-4c96-bc2c-335d7a5a0274"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F559c9ccf-7ebb-48b6-87a1-b697ba626e39%2FScreen_Shot_2021-08-19_at_1.02.00_AM.png?width=432&amp;table=block&amp;id=02fcee71-d26b-4c96-bc2c-335d7a5a0274" style="width:432px"/></a><figcaption><span class="SemanticStringArray"><span class="SemanticString">the dragon queen&#x27;s name is unisex</span></span></figcaption></figure></div><div id="https://www.notion.so/a3d4b2bec68848928fc976f8960ca701" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F8a920dc2-a28b-4255-a020-9a84dc1afc54%2FScreen_Shot_2021-08-19_at_12.56.22_AM.png?width=432&amp;table=block&amp;id=a3d4b2be-c688-4892-8fc9-76f8960ca701"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F8a920dc2-a28b-4255-a020-9a84dc1afc54%2FScreen_Shot_2021-08-19_at_12.56.22_AM.png?width=432&amp;table=block&amp;id=a3d4b2be-c688-4892-8fc9-76f8960ca701" style="width:432px"/></a><figcaption><span class="SemanticStringArray"><span class="SemanticString">the elf with no master is male</span></span></figcaption></figure></div><h3 id="https://www.notion.so/cb6ba4815df54b2283ae5844cd1937dc" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/cb6ba4815df54b2283ae5844cd1937dc"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">moment of truth</span></span></h3><div id="https://www.notion.so/cb977e10220d42d4bd802e4adedcb432" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Aha! There it is. The model thinks my first-name sounds feminine to most of the western world; in India and few other places it is unisex. This prediction is largely in line with my experiential findings. Luckily the model predicts my nickname </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Sesh</em></span><span class="SemanticString"> sounds masculine to most of the world.</span></span></p></div><div id="https://www.notion.so/f8624b688c3b44c5afb48d64f14de6b0" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F21068d47-b2bd-4e81-b347-0fce0b43f847%2FScreen_Shot_2021-08-19_at_1.04.26_AM.png?width=432&amp;table=block&amp;id=f8624b68-8c3b-44c5-afb4-8d64f14de6b0"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F21068d47-b2bd-4e81-b347-0fce0b43f847%2FScreen_Shot_2021-08-19_at_1.04.26_AM.png?width=432&amp;table=block&amp;id=f8624b68-8c3b-44c5-afb4-8d64f14de6b0" style="width:432px"/></a><figcaption><span class="SemanticStringArray"><span class="SemanticString">my firstname</span></span></figcaption></figure></div><div id="https://www.notion.so/dc5f0a507f7e4076b64a0892f5596171" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa214eda1-6f3e-4221-9d77-cd51238e7f26%2FScreen_Shot_2021-08-19_at_1.04.39_AM.png?width=432&amp;table=block&amp;id=dc5f0a50-7f7e-4076-b64a-0892f5596171"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa214eda1-6f3e-4221-9d77-cd51238e7f26%2FScreen_Shot_2021-08-19_at_1.04.39_AM.png?width=432&amp;table=block&amp;id=dc5f0a50-7f7e-4076-b64a-0892f5596171" style="width:432px"/></a><figcaption><span class="SemanticStringArray"><span class="SemanticString">my nickname</span></span></figcaption></figure></div><h3 id="https://www.notion.so/b46f24b49b92409992a4a8a62bcaf35c" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/b46f24b49b92409992a4a8a62bcaf35c"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">observations</span></span></h3><div id="https://www.notion.so/f7187d43d949459f8a2f4c8b8c76badd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The model does well on made up names that sound male (ex: H</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">alperbertson</em></span><span class="SemanticString">) or female (ex: </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Marienneesa</em></span><span class="SemanticString">). Starting with a name and altering its characters reveals which sounds the model is sensitive to (ex: Amir</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"> </em></span><span class="SemanticString">to Amira)</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">.</em></span><span class="SemanticString"> It also appears to do a good job generalizing, predicting gender in countries where names were not seen. However there are plenty of spectacular mistakes. For instance &#x27;Nikita&#x27; is predicted as female (apologies to Mr.Khrushchev), &#x27;</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Gal Gaddot</em></span><span class="SemanticString">&#x27; as male. Some countries have sparse training data/coverage issues which comes through in the quality of its predictions.</span></span></p></div><div id="https://www.notion.so/c48fef32a9b04a34bc35c23734242086" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/ab553ca82aa747c9afaddeec87af3a3c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">The model does well at predicting gender for brand names. The predictions below make sense to me; my blind guesses for the same more or less match the model results. Interestingly </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://journals.sagepub.com/doi/full/10.1177/0022242921993060">studies</a></span><span class="SemanticString"> indicate that feminine brand names are perceived by consumers as warmer and are better liked and frequently chosen. Before naming your next company do run it by the model!</span></span></p></div><div id="https://www.notion.so/d49f49be51ca4c9996dca25217afcbeb" class="CollectionInline"><h3><a class="Anchor" href="#https://www.notion.so/d49f49be51ca4c9996dca25217afcbeb"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">brand gender</span></span></h3><div class="Table"><table><thead><tr><th style="width:276px">Brand Name</th><th>Prediction (USA)</th></tr></thead><tbody><tr><td class="Table__CellTitle"><a href="https://www.notion.so/ee11adf9841541faa9fe7268795b36b4"><span class="SemanticStringArray"><span class="SemanticString">Tesla</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedBg SemanticString__Fragment--BgPink">female</mark></span></span></td></tr><tr><td class="Table__CellTitle"><a href="https://www.notion.so/45bbe5daea154bf2af1ae967fa5f2529"><span class="SemanticStringArray"><span class="SemanticString">Oura</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedBg SemanticString__Fragment--BgPink">female</mark></span></span></td></tr><tr><td class="Table__CellTitle"><a href="https://www.notion.so/b6ed268f287c4c8c8cec2861a04b27fb"><span class="SemanticStringArray"><span class="SemanticString">Apple</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedBg SemanticString__Fragment--BgGreen">unisex</mark></span></span></td></tr><tr><td class="Table__CellTitle"><a href="https://www.notion.so/d1c1dc127a2740b3b86d764c757edfcb"><span class="SemanticStringArray"><span class="SemanticString">Amazon</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedBg SemanticString__Fragment--BgBlue">male</mark></span></span></td></tr><tr><td class="Table__CellTitle"><a href="https://www.notion.so/9d95f445a90845b49b749afcba9fcc8f"><span class="SemanticStringArray"><span class="SemanticString">SpaceX</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedBg SemanticString__Fragment--BgBlue">male</mark></span></span></td></tr></tbody></table></div></div><h3 id="https://www.notion.so/a41465b46ed1437e92025fbe6f106b44" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/a41465b46ed1437e92025fbe6f106b44"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">thoughts</span></span></h3><div id="https://www.notion.so/bb31ee8ff4ec4e48ab9419c072f1ff9b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">To deploy such a model for any practical application needs a whole lot more work. Name gender relationship is constantly evolving (ex: </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Kanye</em></span><span class="SemanticString">&#x27;s daughter </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">North West</em></span><span class="SemanticString">) and any model trained on a snapshot-in-time will have a finite shelf life. Pronoun scores for a name derived from global/local web-texts is a highly predictive signal that is worth adding. Features could also be extracted from online personas with those names. A potentially larger, current dataset could even be bootstrapped from Wikipedia. Such signals/datasets would need to be precomputed or created online using search-apis both of which would make the system more complicated.</span></span></p></div><div id="https://www.notion.so/e48637b6d98c42ab942e10bb9f22e02d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/4babbbe3153c466ab6ead7c05e7472c2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">In a world where in-person interactions are reducing and online interactions are quickly becoming the norm, the gender clues left by our name or user-name can trigger subconscious biases. Numerous papers have studied the effect of perceived gender and it&#x27;s accompanied stereotyping on an individual&#x27;s success in the real world - on </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://ojs.aaai.org/index.php/ICWSM/article/view/14711">visibility</a></span><span class="SemanticString">, on </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://link.springer.com/article/10.1007/s10755-014-9313-4">ratings</a></span><span class="SemanticString">, on </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://dl.acm.org/doi/abs/10.1145/3319502.3374778">trust</a></span><span class="SemanticString">. Maybe this should be of interest to us all.</span></span></p></div><div id="https://www.notion.so/a78cfbdb5c364fcb95e7ed9124dfa274" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/63f29c28c046493f8c3e3c393fd7662c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Cheers,</span></span></p></div><div id="https://www.notion.so/04ac2920430740d1a9fbf368af495b7f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike">Seshadri</del></span><span class="SemanticString"> Sesh</span></span></p></div><div id="https://www.notion.so/a73ae1f4f9104a8ba945657f5ebac11c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></article>  <footer class="Footer">
        <div>&copy; less. but better 2019</div>
        <div>&centerdot;</div>
        <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
            rel="noopener noreferrer">Notablog</a>.
        </div>
    </footer>
</body>

</html>